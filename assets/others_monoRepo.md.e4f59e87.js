import{_ as s,c as a,o as n,d as p}from"./app.38b01d5e.js";const l="/assets/babel.b8d1ad02.png",e="/assets/monorepo.11bf4b3b.png",o="/assets/package-b.638f6205.png",m=JSON.parse('{"title":"MonoRepo","description":"","frontmatter":{},"headers":[{"level":2,"title":"monoRepo çš„ä¼˜åŠ¿","slug":"monorepo-çš„ä¼˜åŠ¿","link":"#monorepo-çš„ä¼˜åŠ¿","children":[{"level":3,"title":"æ–¹ä¾¿ç®¡ç†","slug":"æ–¹ä¾¿ç®¡ç†","link":"#æ–¹ä¾¿ç®¡ç†","children":[]},{"level":3,"title":"ä»£ç å¤ç”¨","slug":"ä»£ç å¤ç”¨","link":"#ä»£ç å¤ç”¨","children":[]},{"level":3,"title":"å·¥ç¨‹åŒ–ç»Ÿä¸€","slug":"å·¥ç¨‹åŒ–ç»Ÿä¸€","link":"#å·¥ç¨‹åŒ–ç»Ÿä¸€","children":[]}]},{"level":2,"title":"monoRepo ç¼ºç‚¹","slug":"monorepo-ç¼ºç‚¹","link":"#monorepo-ç¼ºç‚¹","children":[]},{"level":2,"title":"workspaces","slug":"workspaces","link":"#workspaces","children":[{"level":3,"title":"npm workspaces","slug":"npm-workspaces","link":"#npm-workspaces","children":[]},{"level":3,"title":"yarn workspaces","slug":"yarn-workspaces","link":"#yarn-workspaces","children":[]}]},{"level":2,"title":"lerna","slug":"lerna","link":"#lerna","children":[]},{"level":2,"title":"pnpm","slug":"pnpm","link":"#pnpm","children":[]}],"relativePath":"others/monoRepo.md"}'),c={name:"others/monoRepo.md"},r=p('<h1 id="monorepo" tabindex="-1">MonoRepo <a class="header-anchor" href="#monorepo" aria-hidden="true">#</a></h1><p>monoRepo å…¶å®å°±æ˜¯å°†å¤šä¸ªé¡¹ç›®æ•´åˆåˆ°ä¸€ä¸ª git é¡¹ç›®ä¸­è¿›è¡Œç®¡ç†çš„ä¸€ç§æ–¹å¼ã€‚åº”è¯¥å¤§å®¶éƒ½æœ‰ç”¨è¿‡æˆ–è€…è§è¿‡è¿™ç§ä»£ç ç®¡ç†æ–¹å¼ï¼Œå¯èƒ½ä¸æ¸…æ¥šè¿™ä¸ªåè¯è€Œå·²ã€‚å¾ˆå¤šçŸ¥åå¼€æºé¡¹ç›®éƒ½é‡‡ç”¨äº†è¿™ç§æ–¹å¼ï¼Œæ¯”å¦‚ babelã€vue3 ç­‰ç­‰ã€‚</p><p><img src="'+l+'" alt="babel"></p><p>ä¸ monoRepo ç›¸å¯¹åº”çš„å°±æ˜¯å°†å¤šä¸ªé¡¹ç›®åˆ†å¼€åœ¨ä¸åŒçš„ä»£ç ä»“åº“ä¸­è¿›è¡Œç®¡ç†ï¼Œå³ multiRepoã€‚ä¸¤è€…çš„å…³ç³»å¯ä»¥è§ä¸‹å›¾ã€‚monoRepo ä¹Ÿè¢«ç§°ä½œ <code>multi-package repositories</code>ï¼Œæ³¨æ„å’Œ <code>multiRepo</code> åŒºåˆ†å¼€ ğŸ§ã€‚</p><p><img src="'+e+`" alt="monoRepo"></p><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ monoRepo èƒ½ä¸ºæˆ‘ä»¬è§£å†³å“ªäº›ä¾¿åˆ©ï¼Œä»¥åŠæˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦ monoRepoï¼Ÿ</p><h2 id="monorepo-çš„ä¼˜åŠ¿" tabindex="-1">monoRepo çš„ä¼˜åŠ¿ <a class="header-anchor" href="#monorepo-çš„ä¼˜åŠ¿" aria-hidden="true">#</a></h2><h3 id="æ–¹ä¾¿ç®¡ç†" tabindex="-1">æ–¹ä¾¿ç®¡ç† <a class="header-anchor" href="#æ–¹ä¾¿ç®¡ç†" aria-hidden="true">#</a></h3><p>åœ¨æ–°äººå…¥èŒå…¬å¸ä¹‹åï¼Œä¸å‡ºæ„å¤–çš„è¯ï¼Œç¬¬ä¸€å¤©åº”è¯¥éƒ½æ˜¯åœ¨å¼€é€šå„ç§ Git ä»“åº“çš„æƒé™ï¼ŒæŠŠé¡¹ç›®ä»£ç ä¸€ä¸ªä¸ª clone ä¸‹æ¥ï¼Œç„¶åéœ€è¦åœ¨æ¯ä¸ªé¡¹ç›®å®‰è£…ä¾èµ–ï¼Œæœ€åæ‰èƒ½å°†ä»£ç è·‘èµ·æ¥ã€‚</p><p>å¦‚æœé‡‡ç”¨ monoRepo çš„ç®¡ç†æ–¹å¼çš„è¯ï¼Œè¿™ä¸ªè¿‡ç¨‹å°†ä¼šå˜å¾—ç®€å•ä¸å°‘ã€‚å› ä¸ºä»£ç å…¨éƒ¨éƒ½é›†ä¸­åœ¨ä¸€ä¸ªä»“åº“ä¸­è¿›è¡Œç®¡ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ clone ä¸€ä¸ª Git ä»“åº“ï¼Œå¾ˆä¾¿æ·çš„å°±å¯ä»¥å°†ä¾èµ–å®‰è£…å¥½ï¼Œå¹¶å¯åŠ¨ä»»æ„é¡¹ç›®ã€‚è™½ç„¶å®‰è£…ä¾èµ–è¿‡ç¨‹éœ€è¦çš„æ—¶é—´æ¯”å®‰è£…å•ä¸ªé¡¹ç›®ä¾èµ–è¦é•¿ï¼Œä½†ç”±äº monoRepo èƒ½å¤Ÿå°†é¡¹ç›®ä¸‹çš„ä¾èµ–æŒ‰ç…§ä¸€å®šçš„è§„åˆ™è¿›è¡Œæå‡ï¼Œæ‰€ä»¥ node_modules çš„ä½“ç§¯è‚¯å®šæ˜¯è¦å°äº multiRepo çš„ã€‚</p><h3 id="ä»£ç å¤ç”¨" tabindex="-1">ä»£ç å¤ç”¨ <a class="header-anchor" href="#ä»£ç å¤ç”¨" aria-hidden="true">#</a></h3><p>èº«ä¸ºä¸€ä¸ªæœ‰æ“å®ˆçš„ç¨‹åºå‘˜ï¼Œå¤§å®¶è‚¯å®šéƒ½æœ‰åœ¨éµå¾ªç€ <strong>DRY</strong> (Donâ€™t Repeat Yourself) åŸåˆ™ï¼Œå³å°½é‡çš„å»å®ç°ä»£ç å¤ç”¨ã€‚åœ¨å•ä¸ªé¡¹ç›®ä¸­å®ç°ä»£ç å¤ç”¨éå¸¸çš„ç®€å•ï¼Œå¯ä»¥å°†éœ€è¦å¤ç”¨çš„ä»£ç å­˜æ”¾åœ¨å•ç‹¬çš„æ–‡ä»¶å¤¹ä¸­ï¼Œéœ€è¦æ—¶ä»è¿™é‡Œå–å³å¯ã€‚</p><p>å¦‚æœæ˜¯åœ¨ä¸åŒçš„é¡¹ç›®ä¹‹é—´éœ€è¦è¿›è¡Œä»£ç å¤ç”¨å‘¢ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿæœ‰åŠæ³•ï¼Œæ¯”å¦‚å°†å¤ç”¨é€»è¾‘æå–ä¸º npm åŒ…ï¼Œåœ¨éœ€è¦çš„é¡¹ç›®ä¸­å¼•å…¥è¿™ä¸ªåŒ…ä¹Ÿèƒ½å®ç°ä»£ç å¤ç”¨ã€‚</p><p>è¿™ä¸ªæ–¹å¼ä¹Ÿæœ‰ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚åœ¨ npm å¼€å‘æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šä½¿ç”¨ <code>npm link</code> æˆ–è€… <code>yarn link</code>çš„æ–¹å¼æ¥å¼€å‘ã€‚å¦‚æœå¤šäººåä½œå¼€å‘å¤šä¸ª npm åŒ…ï¼Œè¿™ä¸ª link çš„è¿‡ç¨‹è¿˜æ˜¯æŒºç¹ççš„ï¼Œè€Œä¸” link å®‰è£…çš„æœ¬åœ°ä¾èµ–ä¸ä¼šåœ¨ <code>package.json</code> ä½“ç°å‡ºæ¥ï¼Œç­‰åŒ…å‘å¸ƒåˆ° npm æ—¶ï¼Œéœ€è¦å†å…¨éƒ¨å®‰è£…ä¸€éã€‚</p><p>åœ¨é¡¹ç›®ä¸Šçº¿ä¹‹åï¼Œå¦‚æœæœ‰éœ€æ±‚æˆ–è€… bug éœ€è¦å¯¹ npm åŒ…(ç§°ä½œ moduleA å§)ä¸­çš„ä»£ç è¿›è¡Œæ”¹åŠ¨ï¼Œä½ å¯èƒ½éœ€è¦æ‰§è¡Œä»¥ä¸‹å‡ æ­¥</p><ol><li>moduleA åŸºäº master è¿å‡ºæ–°çš„åˆ†æ”¯ï¼Œè¿›è¡Œå¼€å‘</li><li>åœ¨é¡¹ç›®ä¸­ç”¨ link çš„æ–¹å¼å®‰è£… moduleA</li><li>moduleA å¼€å‘å®Œæˆå¹¶æœ¬åœ°è‡ªæµ‹å®Œæˆåï¼Œpush åˆ°æµ‹è¯•åˆ†æ”¯</li><li>é¡¹ç›®ä¹Ÿéœ€è¦åŸºäº master è¿å‡ºæ–°çš„åˆ†æ”¯ï¼Œæ›´æ”¹ moduleA çš„ç‰ˆæœ¬å·ï¼Œæˆ–è€…è¿›è¡Œè¿™ä¸ªéœ€æ±‚çš„å…¶ä»–ä»£ç å¼€å‘ï¼Œå‘å¸ƒåˆ°æµ‹è¯•åˆ†æ”¯</li><li>æµ‹è¯•ç¯å¢ƒæµ‹è¯•æ²¡é—®é¢˜åï¼Œå‘å¸ƒåˆ°æ­£å¼ç¯å¢ƒä¹‹å‰éœ€è¦å…ˆå‘å¸ƒ moduleA</li></ol><p>è¿™ä¸€ç³»åˆ—æ“ä½œä¸‹æ¥è¿˜æ˜¯æ¯”è¾ƒç¹ççš„ï¼Œå¯¹å…¬æœ‰ npm åŒ…çš„ç®¡ç†ä¹Ÿéœ€è¦ä¸€å®šçš„æˆæœ¬ã€‚ç„¶è€Œï¼Œå¦‚æœä½ é€‰ç”¨äº† monoRepoï¼Œä¸Šé¢çš„é—®é¢˜åº”è¯¥éƒ½å¯ä»¥è¾ƒå¥½çš„è§£å†³ã€‚</p><p>åœ¨ monoRepo ä¸­è¿›è¡Œä»£ç å¤ç”¨å°±è·Ÿåœ¨å•ä¸ªé¡¹ç›®ä¸­ä¸€æ ·çš„ç®€å•ï¼ŒåŒæ ·å°†å¤ç”¨ä»£ç æå–åœ¨å•ç‹¬çš„æ–‡ä»¶å¤¹ã€‚åœ¨è¿­ä»£å¼€å§‹æ—¶ï¼Œå¯ä»¥åŸºäºä¸€ä¸ª commit æäº¤æœ¬æ¬¡æ›´æ–°çš„å†…å®¹ï¼Œä¹Ÿä¾¿äºä»£ç  reviewã€‚</p><h3 id="å·¥ç¨‹åŒ–ç»Ÿä¸€" tabindex="-1">å·¥ç¨‹åŒ–ç»Ÿä¸€ <a class="header-anchor" href="#å·¥ç¨‹åŒ–ç»Ÿä¸€" aria-hidden="true">#</a></h3><p>åœ¨ multi repo çš„é¡¹ç›®ä¸­ï¼Œç”±äºæ¯ä¸ªé¡¹ç›®éƒ½æ˜¯å‰²è£‚çš„ï¼Œæ‰€ä»¥æ¯ä¸ªé¡¹ç›®éƒ½éœ€è¦å•ç‹¬çš„ eslintã€prettier ä»¥åŠå…¶ä»–ä¸€äº›åŸºç¡€å»ºè®¾ï¼Œè¿™æ ·çš„å·¥ä½œéƒ½æ˜¯é‡å¤ä¸”ç®€å•çš„ï¼Œå¦‚æœè¦åœ¨æ¯ä¸ªé¡¹ç›®ä¸­éƒ½ä¿æŒè§„åˆ™ã€ä»£ç é£æ ¼çš„ç»Ÿä¸€ï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨æ¯ä¸ªé¡¹ç›®ä¸­ CV è¿™éƒ¨åˆ†é€»è¾‘ï¼Œ(åˆæ³•ï¼Œä½†ä¸æå€¡.jpg)ã€‚</p><h2 id="monorepo-ç¼ºç‚¹" tabindex="-1">monoRepo ç¼ºç‚¹ <a class="header-anchor" href="#monorepo-ç¼ºç‚¹" aria-hidden="true">#</a></h2><p>å½“ç„¶ï¼ŒmonoRepo ä¹Ÿå¹¶éé“¶å¼¹ï¼Œå®ƒä¹Ÿå¸¦äº†ä¸€äº›æ–°çš„é—®é¢˜</p><ul><li>å¦‚æœé¡¹ç›®å¤ªå¤§ï¼Œgit æ“ä½œã€å®‰è£…ä¾èµ–ç­‰ä¼šå˜å¾—å¾ˆæ…¢</li><li>monoRepo å°†å¤šä¸ªé¡¹ç›®æ•´åˆåœ¨äº†ä¸€èµ·ï¼Œæ‰€æœ‰é¡¹ç›®éƒ½æ˜¯å¯¹å…¨ä½“å‘˜å·¥å¼€æ”¾çš„ï¼Œæ²¡æœ‰åŠæ³•ä½¿ç”¨ Git å¯¹é¡¹ç›®åšæ–‡ä»¶å¤¹çº§åˆ«çš„æƒé™æ§åˆ¶ã€‚ä»å¦ä¸€æ–¹é¢æ¥è¯´ï¼Œå› ä¸ºä»£ç éƒ½æ˜¯å¼€æ”¾çš„ï¼Œå‘˜å·¥å¯èƒ½å› æ­¤æ›´åŠ æ³¨é‡ä»£ç è´¨é‡ã€‚</li></ul><h2 id="workspaces" tabindex="-1">workspaces <a class="header-anchor" href="#workspaces" aria-hidden="true">#</a></h2><p>workspaces(å·¥ä½œåŒº) ç”± yarn æå‡ºï¼Œç”¨äºç®€åŒ– monoRepo æ¨¡å¼ä¸‹æœ¬åœ°ä¾èµ–åŒ…çš„ç®¡ç†ã€‚åœ¨ workspaces æ¨å‡ºä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ link ï¼Œå½“æœ¬åœ°ä¾èµ–å¤ªå¤šæ—¶ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±ç¨æ˜¾ç¹çäº†ã€‚åœ¨ npm7 ä¹‹åï¼Œnpm ä¹Ÿæä¾›äº†å¯¹ worKspaces çš„æ”¯æŒã€‚ä»¥ npm workspaces ä¸ºä¾‹ç®€å•è®²è®² workspaces çš„ä½¿ç”¨</p><h3 id="npm-workspaces" tabindex="-1">npm workspaces <a class="header-anchor" href="#npm-workspaces" aria-hidden="true">#</a></h3><p>å®šä¹‰ä¸€ä¸ª workspaces é€šå¸¸çš„åšæ³•æ˜¯åœ¨æ ¹ç›®å½• <code>package.json</code> ä¸­æ·»åŠ  <code>workspaces</code> å­—æ®µï¼Œå¹¶åŠ ä¸Š <code>private</code> é˜²æ­¢è¯¯å‘å¸ƒåˆ° npm ä¸Šï¼Œæ¯•ç«Ÿé¡¹ç›®æ–‡ä»¶å¤¹ä¸‹çš„å…¶ä»–é¡¹ç›®æ‰æ˜¯æˆ‘ä»¬çœŸæ­£çš„ npm åŒ…ï¼Œé‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬çš„ <code>package.json</code> åº”è¯¥å°±æ˜¯ä¸‹é¢è¿™æ ·</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">npm-spaces</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">version</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">private</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">workspaces</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">packages/*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>æ­¤æ—¶æˆ‘ä»¬çš„ packages æ–‡ä»¶å¤¹å°±æ˜¯ä¸€ä¸ªå·¥ä½œåŒºï¼Œæˆ‘ä»¬åœ¨ packages æ–‡ä»¶å¤¹æ–°å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ package-aã€package-b å³ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„é¡¹ç›®ï¼Œæ¯ä¸ªæ–‡ä»¶å¤¹ä¸‹éƒ½å»ºä¸€ä¸ªç‹¬ç«‹ package.json æ–‡ä»¶ï¼Œnpm ä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†å‘½ä»¤</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">init</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-w</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">./packages/package-c</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>è¯¥å‘½ä»¤ä¼šè‡ªåŠ¨ä¼šåœ¨ packages æ–‡ä»¶å¤¹ä¸‹åˆ›å»º package-c æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨ package-c æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆ package.jsonã€‚</p><p>å½“æˆ‘ä»¬éœ€è¦åœ¨å­é¡¹ç›®ä¸­å®‰è£…ä¾èµ–æ—¶ï¼Œå¯ä»¥ä½¿ç”¨</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lodash-es</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-b</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-w</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-a</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>ä¸Šé¢çš„å‘½ä»¤å¯ä»¥åœ¨ package-a é¡¹ç›®ä¸­å®‰è£… lodash-es å’Œ package-bï¼Œè¿™ä¸ª package-b ä»“åº“ä¸ä¼šå‰å¾€ npm æºä¸Šå»æŸ¥æ‰¾ï¼Œè€Œæ˜¯å…ˆå¯»æ‰¾å·¥ä½œåŒºå†…æ˜¯å¦å­˜åœ¨è¯¥é¡¹ç›®ï¼Œå­˜åœ¨å°±ç›´æ¥å®‰è£…å·¥ä½œåŒºå†…çš„é¡¹ç›®ã€‚</p><p>æ­¤æ—¶æˆ‘ä»¬çš„é¡¹ç›®åº”è¯¥æ˜¯ä¸‹é¢è¿™ä¸ªç»“æ„</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">â”œâ”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">node_modules</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”œâ”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lodash-es</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”œâ”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-a</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”œâ”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-b</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â””â”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-c</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span></span>
<span class="line"><span style="color:#FFCB6B;">â”œâ”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">packages</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”œâ”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-a</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”‚</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">â””â”€â”€</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">package.json</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”‚</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”œâ”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-b</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”‚</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">â””â”€â”€</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">package.json</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”‚</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â””â”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-c</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">        </span><span style="color:#C3E88D;">â””â”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package.json</span></span>
<span class="line"><span style="color:#FFCB6B;">â””â”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package.json</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>æ­¤æ—¶å¯ä»¥å‘ç° node_modules æ–‡ä»¶å¤¹ä¸‹å­˜åœ¨æˆ‘ä»¬è‡ªå®šä¹‰çš„ä¸‰ä¸ª package ç¬¦å·é“¾æ¥ï¼ŒæŒ‡å‘ packages æ–‡ä»¶å¤¹ä¸‹å¯¹åº”çš„æ–‡ä»¶å¤¹ã€‚</p><h3 id="yarn-workspaces" tabindex="-1">yarn workspaces <a class="header-anchor" href="#yarn-workspaces" aria-hidden="true">#</a></h3><p>yarn workspaces è·Ÿ npm ç”¨æ³•ç›¸ä¼¼ï¼Œå‡è®¾æˆ‘ä»¬å·²ç»æœ‰äº† packages æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹ä¸‹æœ‰ <code>package-a</code>ï¼Œ<code>package-b</code>ï¼Œ<code>package-c</code>ä¸‰ä¸ªå­æ–‡ä»¶å¤¹ï¼Œä¸”éƒ½æœ‰è‡ªå·±çš„ <code>package.json</code></p><p>æˆ‘ä»¬ä½¿ç”¨ <code>yarn workspace</code> å‘½ä»¤æ¥å®‰è£…ä¾èµ–</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yarn</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">workspace</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-a</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">react</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-b</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-S</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>å³åœ¨ package-a é¡¹ç›®ä¸­ï¼Œå®‰è£… react å’Œ package-b åŒ…ï¼Œç‚¹å¼€ node_modules ä¸€çœ‹ï¼Œå¥½å®¶ä¼™ï¼Œpackage-b å®‰è£…çš„ç‰ˆæœ¬æ˜¯ 0.5ï¼Œæ ¹æœ¬ä¸æ˜¯æˆ‘ä»¬é¢„æƒ³ä¸­çš„æœ¬åœ° package-bã€‚</p><p>æ‰“å¼€ npm æœç´¢ package-bï¼Œå››å¹´å‰å°±æœ‰äººæŠŠ <code>package-b</code> åŒ…ä¸Šä¼ åˆ° npm äº†(è¿˜æœ‰ä¸€ä¸ª <code>package-c</code> ä¹Ÿæ˜¯ä»–ä¸Šä¼ çš„ ğŸ˜‘)ã€‚æ¸©é¦¨æç¤ºï¼Œå®è·µçš„æ—¶å€™å¯ä»¥æ­å»ºç§æœ‰ npm æœåŠ¡ï¼Œå°† demo ä¸Šä¼ åˆ°å…¬æœ‰ä»“åº“æ˜¯ä¸å¤ªä¼˜é›…çš„ã€‚</p><p><img src="`+o+`" alt="package-b"></p><p>å¦‚æœéœ€è¦å®‰è£…æœ¬åœ°çš„åŒ…ï¼Œåˆ™éœ€è¦æŒ‡å®š version æ¥ç²¾ç¡®åŒ¹é…ï¼Œç„¶åæˆ‘æŠŠæœ¬åœ° package-b version æ”¹ä¸º 0.5.0ï¼ˆä¸ºäº†çœ‹åŒ¹é…çš„æ˜¯æœ¬åœ°è¿˜æ˜¯ npm æºï¼‰</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yarn</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">workspace</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-a</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-b@</span><span style="color:#F78C6C;">0.5</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-S</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>å—¯ï¼Œè¿™å›æ²¡æœ‰å» npm æºä¸‹è½½</p><p>ä½†æ˜¯è¿™æ ·è‚¯å®šä¸è¡Œï¼Œä¸ºäº†é¿å…å®‰è£…éå·¥ä½œåŒºåŒ…å¯èƒ½å¸¦æ¥çš„é£é™©ï¼Œ yarn V2 æ¨å‡ºäº† <a href="https://yarnpkg.com/features/workspaces#workspace-ranges-workspace" target="_blank" rel="noreferrer">workspace</a> åè®®ï¼Œä½¿ç”¨ workspace åè®®åï¼Œä¸å†èƒ½å¤Ÿå®‰è£…å·¥ä½œåŒºä¹‹å¤–çš„ä¾èµ–ï¼Œæ‰§è¡Œä¸‹é¢çš„å®‰è£…å‘½ä»¤</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yarn</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">workspace</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-a</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-b</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-D</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>package-a ä¸‹çš„ <code>package.json</code>åº”è¯¥å¦‚ä¸‹ï¼Œé™¤éä½ æ‰‹åŠ¨æ›´æ”¹ package-b çš„ç‰ˆæœ¬å·ä¸ºé workspace çš„å®‰è£…æ–¹å¼ï¼Œå¦åˆ™ package-b å°†ä¸€ç›´é‡‡ç”¨å·¥ä½œåŒºä¸­çš„ç‰ˆæœ¬ã€‚</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">package-a</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">version</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">main</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">index.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">devDependencies</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">package-b</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">workspace:^</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>å‡è®¾ä½ æŸä¸ªé¡¹ç›® PackA çš„ package.json å¦‚ä¸‹ï¼Œä¸”æ‰€æœ‰å·¥ä½œåŒºé¡¹ç›®çš„ç‰ˆæœ¬éƒ½ä¸º 1.5.0</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">dependencies</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">star</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">workspace:*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">caret</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">workspace:^</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">tilde</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">workspace:~</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">range</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">workspace:^1.2.3</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">path</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">workspace:path/to/baz</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>åœ¨ä½ å‘å¸ƒ PackA æ—¶ï¼ŒPackA ä¸‹çš„ package.json å°†ä¼šæ ¹æ® semver è§„åˆ™è¿›è¡Œè½¬æ¢æˆå¦‚ä¸‹çš„å½¢å¼</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">dependencies</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">star</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.5.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">caret</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">^1.5.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">tilde</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">~1.5.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">range</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">^1.2.3</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">path</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.5.0</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="lerna" tabindex="-1">lerna <a class="header-anchor" href="#lerna" aria-hidden="true">#</a></h2><p>å¦‚æœä½ äº†è§£è¿‡ monoRepoï¼Œé‚£ä¹ˆä½ åº”è¯¥ä¹Ÿå¬è¿‡ lernaï¼Œç”¨ <a href="https://lerna.js.org/" target="_blank" rel="noreferrer">lerna</a> å®˜ç½‘ä¸­çš„è¯æ¥æ¦‚æ‹¬ lerna</p><blockquote><p>Lerna is a tool that optimizes the workflow around managing multi-package repositories with git and npm.</p></blockquote><p>lerna çš„æ ¸å¿ƒæŒ‡ä»¤æ˜¯ <code>lerna bootstrap</code> å’Œ <code>lerna publish</code>ï¼Œå‰è€…å¤„ç†ä¾èµ–é—®é¢˜ï¼Œåè€…è§£å†³å‘å¸ƒé—®é¢˜ï¼Œè¿™é‡Œç®€å•çš„ä»‹ç»ä¸€ä¸‹ lerna çš„ä½¿ç”¨ã€‚</p><p>è®©æˆ‘ä»¬å…ˆç”¨ <code>lerna init</code> æ–°å»ºä¸€ä¸ª lerna é¡¹ç›®ï¼Œå¹¶åœ¨ packages æ–‡ä»¶å¤¹ä¸‹ä½¿ç”¨ <code>lerna create</code> åˆ›å»º <code>package-a</code>, <code>package-b</code> å’Œ <code>package-c</code> ä¸‰ä¸ªå­é¡¹ç›®ï¼Œåœ¨ä¸‰ä¸ªé¡¹ç›®ä¸­éƒ½å®‰è£…ä¸Šä¾èµ–ã€‚</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">lerna</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">axios</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--scope</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-a</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>è¿™æ—¶å€™æŸ¥çœ‹æˆ‘ä»¬çš„æ–‡ä»¶å¤¹ï¼Œåº”è¯¥æ˜¯ä¸‹é¢çš„ç»“æ„</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">â”œâ”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">packages</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”œâ”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-a</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”‚</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">â”œâ”€â”€</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">node_modules</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”‚</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â””â”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">axios</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”‚</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">â””â”€â”€</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">package.json</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”‚</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”œâ”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-b</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”‚</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">â”œâ”€â”€</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">node_modules</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”‚</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â””â”€â”€</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">axios</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”‚</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">â””â”€â”€</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">package.json</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”‚</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â””â”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-b</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”‚</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">â”œâ”€â”€</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">node_modules</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â”‚</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">â”‚</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">â””â”€â”€</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">axios</span></span>
<span class="line"><span style="color:#FFCB6B;">â”‚</span><span style="color:#A6ACCD;">        </span><span style="color:#C3E88D;">â””â”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package.json</span></span>
<span class="line"><span style="color:#FFCB6B;">â”œâ”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lerna.json</span></span>
<span class="line"><span style="color:#FFCB6B;">â””â”€â”€</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package.json</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>å¯ä»¥çœ‹åˆ° lerna åœ¨ä¸‰ä¸ªé¡¹ç›®ä¸­éƒ½å®‰è£…äº† axiosï¼Œæ˜¾ç„¶æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚lerna ä¹Ÿæä¾›äº†æ–¹æ³•å»å¤„ç†ä¾èµ–é—®é¢˜ã€‚</p><p>å…ˆç”¨ <code>lerna clean</code> å»æ¸…é™¤æ‰æ‰€æœ‰ package ä¸‹çš„ node_modulesï¼Œç„¶åç”¨ <code>lerna bootstrap --hoist</code> å°†æ‰€æœ‰ä¾èµ–éƒ½æå‡è‡³æ ¹ç›®å½•ã€‚</p><p>é€šè¿‡ä¸Šé¢ yarn workspace æˆ‘ä»¬çŸ¥é“ yarn ä¹Ÿæ˜¯æœ‰ä¾èµ–æå‡èƒ½åŠ›ï¼Œä¸”æ‹¥æœ‰æ¯” lerna æ›´å¥½çš„ä¾èµ–åˆ†æå’Œæå‡èƒ½åŠ›ï¼Œè€Œä¸” yarn æä¾›çš„å®‰è£…æ›´å‹å¥½ï¼Œä¸ç”¨å…ˆå®‰è£…åˆ° package é¡¹ç›® ä¸‹ï¼Œå†æ‰§è¡Œ <code>learn bootstrap --hoist</code> åˆ°æ ¹ç›®å½•ä¸‹ï¼Œå®ç°æ— æ„ŸçŸ¥çš„ä¾èµ–æå‡ï¼Œlerna è‡ªèº«ä¹Ÿæ¨èä½¿ç”¨ <code>yarn workspace</code> æ¥è¿›è¡Œä¾èµ–ç®¡ç†ã€‚</p><p>æ‰€ä»¥ä¸€ä¸ªè¾ƒå¥½çš„å®è·µæ˜¯ä½¿ç”¨ <code>yarn workspaces</code> çš„æ–¹å¼æ¥ç®¡ç† lerna ä¸‹çš„ä¾èµ–å…³ç³»ï¼Œåœ¨ <code>lerna.json</code> ä¸­æ·»åŠ ä¸Šä¸‹é¢å­—æ®µä¸”åœ¨ package.json ä¸­æ·»åŠ  workspaces å­—æ®µå³å¯ä½¿ç”¨ yarn ç®¡ç†ä¾èµ–</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">npmClient</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">yarn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">useWorkspaces</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>ä¸Šé¢æœ‰æåˆ° lerna çš„ä¸¤æ¡æ ¸å¿ƒæŒ‡ä»¤æ˜¯ bootstrap å’Œ publishï¼Œbootstrap æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ yarn workspace æ¥æå‡ä¾èµ–ï¼Œä¸”æ¯” lerna åšçš„æ›´å¥½ã€‚publish å¯å°±åªæœ‰æ˜¯ lerna æ“…é•¿çš„åœ°æ–¹äº†ã€‚</p><p>æ¥çœ‹ä¸€ä¸‹æ‰§è¡Œ <code>lerna publish</code> æ—¶åšäº†å“ªäº›äº‹</p><ol><li>æ‰¾å‡ºä¸Šä¸€ä¸ªç‰ˆæœ¬å‘å¸ƒä»¥æ¥æœ‰å˜æ›´çš„ package</li><li>æç¤ºå¼€å‘è€…ç¡®å®šç‰ˆæœ¬å·</li><li>æ›´æ–°éœ€è¦æ›´æ–°çš„ packages çš„ version å­—æ®µ</li><li>åˆ›å»ºæ–°çš„ commit æäº¤åˆ° git</li><li>å‘å¸ƒåˆ° npm</li></ol><p>ä¹Ÿæœ‰ä¸€äº› lerna é€‚ç”¨çš„ç”Ÿæˆ changelog åŒ…ï¼Œæ¯”å¦‚ <a href="https://www.npmjs.com/package/lerna-changelog" target="_blank" rel="noreferrer">lerna-changelog</a> ã€<a href="https://www.npmjs.com/package/cz-lerna-changelog" target="_blank" rel="noreferrer">cz-lerna-changelog</a>ç­‰ç­‰ã€‚</p><h2 id="pnpm" tabindex="-1">pnpm <a class="header-anchor" href="#pnpm" aria-hidden="true">#</a></h2><p>å°½ç®¡ lerna + yarn workspace èƒ½å¤Ÿå¾ˆå¥½çš„è§£å†³ monoRepo å¼€å‘ä¸­çš„é—®é¢˜ï¼Œç›®å‰çš„ monoRepo é¡¹ç›®ä¹Ÿå¤§éƒ½æ˜¯åŸºäº lerna + work workspace ï¼Œç”šè‡³ä¸€åº¦è¢«å¼€å‘è€…è®¤ä½œ monoRepo å¼€å‘çš„æœ€ä½³å®è·µã€‚ä½†æ˜¯ learn åœ¨æŒºä¹…ä»¥å‰å°±å·²ç»å¤„äºä¸€ä¸ª<a href="https://github.com/lerna/lerna/issues/2703" target="_blank" rel="noreferrer">æ— äººç»´æŠ¤</a>çš„çŠ¶æ€ã€‚</p><p>äºæˆ‘è€Œè¨€ï¼Œæˆ‘æ˜¯ä¸å¤§æƒ³å»ç”¨æ— äººç»´æŠ¤çš„å·¥å…·çš„ï¼Œäºæ˜¯æˆ‘åˆæ‰¾åˆ°äº† pnpmã€‚</p><p>pnpm ç›¸æ¯”äº npm æˆ–è€… yarnï¼Œå®ƒçš„ç”¨æˆ·é‡å’ŒçŸ¥ååº¦éƒ½ä¸æ˜¯å¾ˆé«˜ï¼Œä½†å®ƒä¹Ÿå‡­å€Ÿç€ä¸€äº›ä¼˜åŠ¿ï¼Œæ¯”å¦‚å¿«é€Ÿã€èŠ‚çœç©ºé—´çš„ä¾èµ–å®‰è£…ã€ä¸¥æ ¼çš„ä¾èµ–ç®¡ç†ï¼Œä»¥åŠä¼˜ç§€çš„ monoRepo æ”¯æŒï¼Œå¾—åˆ°äº†ä¸€éƒ¨åˆ†äººçš„å–œçˆ±ã€‚</p><p>å‰æ®µæ—¶é—´ï¼Œvue å®Œæˆäº†ä» <code>yarn workspaces</code> åˆ° <code>pnpm workspaces</code> çš„<a href="https://github.com/vuejs/core/commit/61c5fbd3e35152f5f32e95bf04d3ee083414cecb" target="_blank" rel="noreferrer">è¿ç§»</a>ï¼Œå¯èƒ½åœ¨ä¸ä¹…ä¹‹åï¼Œvue ç”Ÿæ€çš„éƒ½ä¼šå®Œæˆå‘ pnpm çš„è¿ç§»ã€‚</p><p>è¿™ç¯‡ä¸»è¦ä» workspace çš„è§’åº¦æ¥çœ‹ pnpm ä¸ºæˆ‘ä»¬å¸¦æ¥çš„ä¾¿åˆ©ã€‚å…³äºä» lerna åˆ° pnpm çš„è¿ç§»å¯ä»¥å‚è€ƒè¿™ç¯‡<a href="https://www.raulmelo.dev/blog/replacing-lerna-and-yarn-with-pnpm-workspaces" target="_blank" rel="noreferrer">Replacing Lerna + Yarn with PNPM Workspaces</a></p><p>ä½ éœ€è¦æ–°å¢ä¸€ä¸ª <code>pnpm-workspace.yaml</code> æ–‡ä»¶ï¼Œ</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F07178;">prefer-workspace-packages</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#F07178;">packages</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">packages/*</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>packages å­—æ®µè·Ÿ package.json ä¸­çš„ workspaces å­—æ®µä½œç”¨ä¸€è‡´ã€‚</p><p>å¦‚æœéœ€è¦åœ¨ç‰¹å®šçš„ package ä¸‹å®‰è£…ä¾èµ–ï¼Œå¯ä»¥æ‰§è¡Œ</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-a</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">axios</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--filter</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-b</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>ä¸Šé¢çš„å‘½ä»¤å³åœ¨ package-b ä¸­å®‰è£… package-a å’Œ axiosï¼Œä¸Šé¢çš„ --filter ç±»ä¼¼ lerna çš„ --scopeï¼Œå…³äºä¸¤è€…çš„æ¯”è¾ƒå¯ä»¥æŸ¥çœ‹<a href="https://medium.com/pnpm/pnpm-vs-lerna-filtering-in-a-multi-package-repository-1f68bc644d6a" target="_blank" rel="noreferrer">pnpm vs Lerna: filtering in a multi-package repository</a></p><p>æ­¤æ—¶ package-a ä¸­çš„ package.json åº”è¯¥æ˜¯ä¸‹é¢çš„æ ·å­ã€‚</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">package-a</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">version</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">dependencies</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">axios</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">^0.24.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">package-b</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">workspace:^1.0.0</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>å¯ä»¥çœ‹åˆ° pnpm ä¹Ÿæ”¯æŒäº† workspace åè®®ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å»ºä¸€ä¸ª demo æ¥ç®€å•èµ°ä¸€ä¸‹ pnpm workspaces ä»å¼€å‘åˆ°å‘å¸ƒçš„è¿‡ç¨‹ã€‚æˆ‘ä»¬åœ¨ packages æ–‡ä»¶å¤¹è§ä¸‰ä¸ªé¡¹ç›® package-aã€package-bã€package-cï¼Œå°±ç®€ç§° PAã€PBã€PC å§ã€‚å…¶ä¸­å‰ä¸¤ä¸ªä½œä¸ºå·¥å…·åº“ï¼ŒPC ä½œä¸ºä¸šåŠ¡é¡¹ç›®ã€‚</p><p>æˆ‘ä»¬åœ¨ PB ä¸­ï¼Œå®‰è£… <code>lodash-es</code>åŒ…ï¼Œ</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lodash-es</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--filter</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-b</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>å¹¶åœ¨å…¥å£æ–‡ä»¶ä¸­æš´éœ²å‡ºä¸€ä¸ªå‡½æ•°</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// package-b</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">random</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">lodash-es</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">randomNum</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">min</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">max</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">random</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">min</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">max</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>é¡ºå¸¦ä¸€æï¼Œåœ¨ pnpm ä¸­çš„ npm åŒ…ä¸­ï¼Œè¿˜å¯ä»¥å®šä¹‰ publishConfig æ¥è¦†ç›–å‘å¸ƒä¹‹åçš„ package.json æ–‡ä»¶ï¼Œä¸¾ä¸ªæ —å­</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">version</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">main</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">src/index.ts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">publishConfig</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">main</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">dist/index.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">typings</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">dist/index.d.ts</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>å‘å¸ƒåˆ° npm ä¸Šæ—¶ï¼Œmain å­—æ®µå°†è¢«è¦†å†™ä¸º <code>dist/index.js</code>ï¼Œå°±å¯ä»¥å®ç°å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒä¸åŒçš„å…¥å£ã€‚</p><p>åœ¨ PA ä¸­ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•å†åšä¸€äº›äº‹</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-b</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--filter</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-a</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// package-a</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">randomNum</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">package-b</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">deleteRandomItem</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">arr</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">arr</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">index</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">randomNum</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">arr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">splice</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">index</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>åœ¨ PC ä¸­æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•äº†ï¼Œ</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-a</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--filter</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package-c</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">deleteRandomItem</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">package-a</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> arr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> [</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#82AAFF;">deleteRandomItem</span><span style="color:#A6ACCD;">(arr)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>å½“ç„¶åœ¨è¿™ä¸ª demo ä¸­è¿™æ ·çš„å°è£…æœ‰äº›å¤šæ­¤ä¸€ä¸¾ï¼Œè¿™é‡Œåªæ˜¯ç”¨æ¥ä»‹ç» pnpm workspaces çš„ä½¿ç”¨ã€‚</p><p>æˆ‘ä»¬çš„åŒ…éƒ½å†™å¥½ä¹‹åï¼Œå°±éœ€è¦è€ƒè™‘å°†åŒ…æäº¤å‘å¸ƒç­‰æ“ä½œäº†ã€‚pnpm æ”¯æŒä½¿ç”¨ <a href="https://github.com/changesets/changesets" target="_blank" rel="noreferrer">changesets</a> æ¥ç®¡ç†ç‰ˆæœ¬ä»¥åŠç”Ÿæˆ changelogã€‚</p><p>åœ¨æ ¹ç›®å½•ä¸‹ï¼Œå®‰è£…ä¾èµ–ï¼Œå¹¶æ‰§è¡Œåˆå§‹åŒ–ã€‚</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-DW</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@changesets/cli</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">changeset</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">init</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ä¼šåœ¨ä½ çš„æ ¹ç›®å½•ä¸‹ç”Ÿæˆ <code>.changeset</code>æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹ä¸‹æœ‰ <code>config.json</code> å’Œ <code>README.md</code> ä¸¤ä¸ªæ–‡ä»¶ï¼Œå…³äº config çš„é…ç½®å¯ä»¥æŸ¥çœ‹<a href="https://github.com/changesets/changesets/blob/main/docs/config-file-options.md" target="_blank" rel="noreferrer">è¿™é‡Œ</a></p><p>æ›´æ”¹ä¹‹åéœ€è¦å‘å¸ƒåˆ° npm ä¹‹å‰ï¼Œéœ€è¦ <code>pnpm changeset</code> æ ¹æ®å‘½ä»¤è¡Œæç¤ºæ¥å‘Šè¯‰ changeset æ­¤æ¬¡æäº¤æ¶‰åŠçš„èŒƒå›´ã€å¦‚ä½•æ›´æ”¹ç‰ˆæœ¬å·ï¼Œä»¥åŠæ›´æ”¹çš„å†…å®¹ã€‚</p><p>ä¹‹å changeset ä¼šåœ¨ .changeset ç”Ÿæˆä¸€ä¸ª md æ–‡ä»¶ï¼ˆæ–‡ä»¶åå¥½åƒæ²¡æœ‰å®é™…æ„ä¹‰ï¼‰ã€‚</p><div class="language-md line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">md</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">---</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">package-a</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">minor</span></span>
<span class="line"><span style="color:#A6ACCD;">---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">æ–°å¢ console</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥å»æ›´æ”¹è¿™äº›ä¿¡æ¯ã€‚æ­¤æ—¶ changeset å·²ç»çŸ¥é“äº†åœ¨å“ªä¸ªé¡¹ç›®é‡Œæ€ä¹ˆå»æ›´æ”¹ç‰ˆæœ¬å·ï¼Œä»¥åŠç‰ˆæœ¬ä¿¡æ¯æ˜¯å•¥äº†ï¼Œä¸Šé¢çš„ md ç›¸å½“äºåœ¨ package-a é¡¹ç›®ä¸­æ‰§è¡Œ</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">version</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">minor</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">æ–°å¢ console</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>æ‰§è¡Œ <code>pnpm changeset version</code>å¯ä»¥ä¾ç…§ md æ–‡ä»¶æ›´æ–°ç‰ˆæœ¬å’Œ changelog</p><p>æ‰§è¡Œ <code>pnpm install</code>é‡æ–°ç”Ÿæˆ lock æ–‡ä»¶ã€‚</p><p>æœ€åæäº¤åˆ° gitï¼Œä»¥åŠ publish åˆ° npmã€‚</p><p>æµ‹è¯•çš„ demo ä¸å»ºè®®æ¨é€åˆ° npmï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://www.npmjs.com/package/verdaccio" target="_blank" rel="noreferrer">verdaccio</a> æ­å»ºä¸€ä¸ªæœ¬åœ°çš„ npm æœåŠ¡ï¼Œæ¯”è¾ƒç®€å•è¿™é‡Œå°±ä¸æäº†ã€‚</p>`,115),t=[r];function D(i,y,C,F,A,d){return n(),a("div",null,t)}const b=s(c,[["render",D]]);export{m as __pageData,b as default};
